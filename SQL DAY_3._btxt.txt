SELECT SUM(SAL) AS TOTAL_SAL FROM SCOTT.EMP GROUP BY DEPTNO ORDER BY TOTAL_SAL;

SELECT SUM(SAL) AS TOTAL_SAL FROM SCOTT.EMP GROUP BY DEPTNO ORDER BY TOTAL_SAL DESC;

--get the department wise total salary for the employess who joined in the year of 1981

SELECT DEPTNO, SUM(SAL), COUNT(*) FROM SCOTT.EMP WHERE HIREDATE < '01-JAN-82' GROUP BY DEPTNO;

SELECT * FROM SCOTT.EMP WHERE HIREDATE< '01-JAN-82';

SELECT DEPTNO, SUM(SAL), COUNT(*) 
    FROM SCOTT.EMP WHERE HIREDATE BETWEEN '01-JAN-82' AND '31-DEC-81' GROUP BY DEPTNO;  

SELECT DEPTNO, SUM(SAL), COUNT(*) 
    FROM SCOTT.EMP WHERE HIREDATE BETWEEN '01-JAN-82' AND '31-DEC-81';

---ROWNUM
SELECT * FROM SCOTT.EMP WHERE ROWNUM<5;

SELECT * FROM SCOTT.EMP WHERE ROWNUM<=6;

--DISPLAY THE DETAILS OF TOP 3 EMPLOYESS SALARY WISE

SELECT * FROM SCOTT.EMP ORDER BY SAL FETCH FIRST 3 ROWS ONLY;

SELECT ENAME FROM SCOTT.EMP WHERE INSTR(UPPER(ENAME), 'A') > 0;

SELECT TO_CHAR(DEPTNO) || '_' || TO_CHAR(EMPNO) AS deptid_empid 
FROM SCOTT.EMP;

SELECT SUBSTR(ENAME, -3) AS last_3_chars FROM SCOTT.EMP WHERE DEPTNO = 20;

SELECT ENAME, NVL2(MGR, 'has a Manager', 'do not have a Manager') AS Manager_Status FROM SCOTT.EMP;

SELECT 
    empno, 
    ename, 
    sal, 
    NVL(
        DECODE(
            TRUE,
            sal < 1000, 'poor sal',
            sal < 2000, 'just okay',
            sal < 3000, 'Good sal',
            'Big Shots'
        ), 'Unknown'
    ) AS sal_comment
FROM 
    scott.emp;



